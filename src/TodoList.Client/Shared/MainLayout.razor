@inherits LayoutComponentBase

@inject NavigationManager NavigationManager
@inject SignOutSessionStateManager SignOutManager

<AuthorizeView>
  <Authorized>
    <div class="user-menu">
      @if (NavigationManager.BaseUri != NavigationManager.Uri)
      {
        <div class="index-page-link">
          <a href="">index page</a>
        </div>
      }
      <div class="dropdown">
        @context.User.Identity?.Name
        <div class="show-menu"></div>
        <div class="dropdown-content">
          @*check the role in claims*@
          @*@if (AppState.IsAdmin)
            {
              <a href="users">Users</a>
            }*@
          <a href="account">Settings</a>
          <a @onclick="OnLogout">Log out</a>
        </div>
      </div>
    </div>
  </Authorized>
  <NotAuthorized>
    <div>
      <div class="login-and-signup">
        <a class="login" href="authentication/login">Log in</a>
        <a class="signup" href="sign-up">Sign up</a>
      </div>
    </div>
  </NotAuthorized>
</AuthorizeView>

@Body

@code {

  private async Task OnLogout(MouseEventArgs args)
  {
    await SignOutManager.SetSignOutState();

    NavigationManager.NavigateTo("authentication/logout");
  }

}
